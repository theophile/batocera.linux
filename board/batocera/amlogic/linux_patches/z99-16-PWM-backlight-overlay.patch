From d1c1210fb9d2276582f8ad12dde1ec43f430d173 Mon Sep 17 00:00:00 2001
From: theophile <chmeredith@gmail.com>
Date: Wed, 5 Oct 2022 19:14:17 -0500
Subject: [PATCH] dt overlays: add PWM backlight overlay

---
 arch/arm64/boot/dts/amlogic/overlay/Makefile  |  3 ++-
 .../overlay/meson-g12a-pwm-backlight.dts      | 25 +++++++++++++++++++
 2 files changed, 27 insertions(+), 1 deletion(-)
 create mode 100644 arch/arm64/boot/dts/amlogic/overlay/meson-g12a-pwm-backlight.dts

diff --git a/arch/arm64/boot/dts/amlogic/overlay/Makefile b/arch/arm64/boot/dts/amlogic/overlay/Makefile
index bae00e0c9d7d3..0f54911ce6f04 100644
--- a/arch/arm64/boot/dts/amlogic/overlay/Makefile
+++ b/arch/arm64/boot/dts/amlogic/overlay/Makefile
@@ -14,7 +14,8 @@ dtbo-$(CONFIG_ARCH_MESON) += \
 	meson-g12a-w1-gpioao-3.dtbo \
 	meson-g12a-gpio-poweroff.dtbo \
 	meson-g12a-gpio-shutdown.dtbo \
-	meson-g12a-ads1015.dtbo
+	meson-g12a-ads1015.dtbo \
+	meson-g12a-pwm-backlight.dtbo
 
 scr-$(CONFIG_ARCH_MESON) += \
 	meson-fixup.scr
diff --git a/arch/arm64/boot/dts/amlogic/overlay/meson-g12a-pwm-backlight.dts b/arch/arm64/boot/dts/amlogic/overlay/meson-g12a-pwm-backlight.dts
new file mode 100644
index 0000000000000..ee253f83178b5
--- /dev/null
+++ b/arch/arm64/boot/dts/amlogic/overlay/meson-g12a-pwm-backlight.dts
@@ -0,0 +1,25 @@
+/dts-v1/;
+/plugin/;
+
+#include <dt-bindings/gpio/gpio.h>
+#include <dt-bindings/gpio/meson-g12a-gpio.h>
+
+/ {
+        compatible = "radxa,zero", "amlogic,g12a";
+
+        fragment@0 {
+                target-path = "/";
+                __overlay__ {
+                       backlight: backlight {
+                               compatible = "pwm-backlight";
+                               power-supply = <&vddao_3v3>;
+                               enable-gpios = <&gpio_ao GPIOAO_10 GPIO_ACTIVE_HIGH>;
+                               pwms = <&pwm_AO_ab 0 1000000 0>;
+                               brightness-levels = <0 255>;
+                               num-interpolated-steps = <255>;
+                               default-brightness-level = <255>;
+                               status = "okay";
+                       };
+               };
+       };
+};
